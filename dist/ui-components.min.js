"use strict";!function(e){function t(e,t,a){if(!a)return t.classList.remove(r.valid,r.invalid),!0;var n=e.test(a);return n?(t.classList.add(r.valid),t.classList.remove(r.invalid)):(t.classList.remove(r.valid),t.classList.add(r.invalid)),n}function a(e){e instanceof Array&&e.forEach(function(e){return a(e)}),e instanceof HTMLElement&&(e.addEventListener("blur",o.blur),e.addEventListener("focus",o.focus),e.addEventListener("change",o.change),e.addEventListener("input",o.input),e.addEventListener("paste",o.change),e.dispatchEvent(new Event("blur")),e.dispatchEvent(new Event("change")),e.__button&&e.__button.addEventListener("click",o.clickButton))}function n(e){return e.hasOwnProperty("__box")||!e.classList.contains(r.field)?e:(e.__box=e.parentNode.classList.contains(r.box)?e.parentNode:null,e.__box?(e.__error=e.__box.querySelector(l.error),e.__label=e.__box.querySelector(l.label),"file"==e.type&&(e.__fake=e.__box.querySelector(l.fieldFake)),e.__button=e.__box.querySelector(l.button),e.__button&&(e.__button.__field=e,e.__button.__icon=e.__button.querySelector(l.buttonIcon)),e):e)}function i(e){var t=[];return e instanceof HTMLCollection&&(e=Array.from(e)),e instanceof Array&&e.forEach(function(e){t=t.concat(i(e))}),e instanceof HTMLElement?(e.classList.contains(r.field)?t.push(n(e)):t=Array.from(e.querySelectorAll(l.field),n),t):t}var r=Object.create(null,{box:{value:"c-field-box"},button:{value:"c-field-button"},buttonIcon:{value:"iconic"},error:{value:"c-field-error"},field:{value:"c-field"},icon:{value:"c-field-icon"},filled:{value:"is-filled"},focused:{value:"is-focused"},invalid:{value:"is-invalid"},valid:{value:"is-valid"}}),l=Object.create(null,{box:{value:"."+r.box},button:{value:"."+r.button},buttonIcon:{value:"."+r.buttonIcon},error:{value:"."+r.error},field:{value:"."+r.field+":not([type=checkbox]):not([type=radio])"},fieldFake:{value:".js-field-fake"},icon:{value:"."+r.icon},filled:{value:"."+r.filled},focused:{value:"."+r.focused}}),o=Object.create(null,{blur:{value:function(e){var t=e.currentTarget.__box,a=e.currentTarget.value,n=a&&"0"!=a&&"null"!=a;t&&t.classList.remove(r.focused),t&&t.classList[n?"add":"remove"](r.filled)}},focus:{value:function(e){var t=e.currentTarget.__box;t&&t.classList.add(r.focused)}},change:{value:function(e){var a=e.currentTarget;if(-1!=["file","email","password"].indexOf(a.type)||a.hasAttribute("pattern")){var n=a.__box,i=a.value.trim();if(!i)return void n.classList.remove("is-valid","is-invalid");if("file"==a.type)return void(a.__fake.value=i);var r=void 0;a.hasAttribute("pattern")?r=new RegExp(a.pattern):"email"==a.type?r=/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/:"password"==a.type&&(r=/^\w{6,20}$/),t(r,n,i)}}},clickButton:{value:function(e){var t=e.currentTarget,a=t.__field;switch(a.type){case"search":var n=a.__box;a.value.trim()||n.classList.add(r.invalid);break;default:var i=t.__icon;"eye-closed"==i.dataset.glyph?(i.dataset.glyph="eye-open",a.setAttribute("type","text")):"eye-open"==i.dataset.glyph&&(i.dataset.glyph="eye-closed",a.setAttribute("type","password"))}}},input:{value:function(e){var a=e.currentTarget;a.hasAttribute("pattern")&&-1==["email","password"].indexOf(a.type)&&t(new RegExp(a.pattern),a.__box,a.value.trim())}}});e.dom.on("ready",function(e){a(i(e))}),e.dom.on("change",function(e,t){t.added.length&&a(i(t.added))})}(UI);